function setOpacity(a,c){c=(c==1)?0.99999:c;a.style.opacity=c;a.style.filter='alpha(opacity='+c*100+')';a.style.MozOpacity=c;a.style.KhtmlOpacity=c}function fade(a,c,f,g){this.elem=a||document.body;this.to=c!==undefined?c:1;var b=this.elem.style;this.from=(f===undefined?(!b.opacity&&b.opacity!==0?(this.to>0?0:1):parseFloat(b.opacity)):f);g=g||{};this.duration=g.duration||500;this.frameRate=g.frameRate||30;this.onFinish=g.onFinish;this.totalFrames=Math.ceil(this.duration/1000*this.frameRate);this.perFrame=(this.to-this.from)/this.totalFrames;this.frameNb=0;var d=this;this.next=function(){this.prog=setTimeout(function(){d.frame()},1000/this.frameRate)};this.frame=function(){setOpacity(this.elem,this.from+this.perFrame*this.frameNb);if(this.frameNb===this.totalFrames){setOpacity(this.elem,this.to);if(typeof this.onFinish=='function'){setTimeout(this.onFinish,1)}}else{this.frameNb++;this.next()}};this.next()}var AjReq=function(){this.defSettings={async:true,encType:"application/x-www-form-urlencoded",encoding:"utf-8",forceMime:null,method:"GET",params:null,abortAfter:5000,onAbort:function(){},onSuccess:function(){},update:null};this.abort=function(){this.xhr.abort();clearTimeout(this.prog);this.options.onAbort()};this.getErrorLog=function(){var a="URL : \n\t"+this.options.url;var c=this.options;a+="\n\nOPTIONS :";for(var f in c){if(c.hasOwnProperty(f)){a+="\n\t"+f+" : "+(f!='response'&&f!='params'?c[f]:'oui ('+typeof c[f]+')')}}var g=this.errorLog;a+="\n\nXHR :\n\treadystate : "+g.readyState+"\n\tstatut : "+g.status+' ('+g.statusText+')';return a};this.getXhr=function(){var a=null;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else if(window.ActiveXObject){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){a=new ActiveXObject("Microsoft.XMLHTTP")}}else{a=false;alert("Votre navigateur ne supporte pas les objets XMLHTTPRequest...")}return a};this.update=function(a,c){if(a.nodeType==1){a=[a]}var f,g=a.length;for(f=0;f<g;f++){a[f].innerHTML=c}};this.resetXhr=function(){this.errorLog={readyState:false,status:false,statusText:false};this.xhr=this.getXhr();this.back={contentType:null,response:null}};this.send=function(g,b){this.resetXhr();this.options=this.errorLog.options=b=transfer(b,this.defSettings);this.options.url=g;var d=this;this.xhr.onreadystatechange=function(){var a=(navigator.appName=="Microsoft Internet Explorer")?parseFloat(navigator.appVersion.replace(/.*MSIE ([^;]+);.*/i,"$1")):null;var c=!a?(window.opera?3:0):(a<8?4:3);d.errorLog={readyState:this.readyState,status:this.readyState>=c?this.status:null,statusText:this.readyState>=c?this.statusText:null};if(d.xhr.readyState===4){clearTimeout(d.prog);d.back.contentType=(b.forceMime||d.xhr.getResponseHeader("Content-Type"))||"text/plain";if(d.back.contentType.indexOf("text/xml")>=0){d.back.response=d.xhr.responseXML}else if(d.back.contentType.indexOf("text/json")>=0){d.back.response=eval('('+d.xhr.responseText+')')}else{d.back.response=d.xhr.responseText}var f=b.update;if(f){d.update(f,d.back.response)}b.onSuccess()}};if(b.method!=='GET'){var h=g.split('?');g=h[0];b.params=h[1]?b.params+h[1]:b.params}else if(b.params){g+='?'+b.params}this.xhr.open(b.method,g,b.async);if(b.method==='POST'){this.xhr.setRequestHeader("Content-Type",b.encType)}this.xhr.send(b.params);if(b.abortAfter){this.prog=setTimeout(function(){d.abort()},b.abortAfter)}}};